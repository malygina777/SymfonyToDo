

{# templates/task/index.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Mes t√¢ches{% endblock %}

{% block body %}
<div class="container py-4">

  {# –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã + –∫–Ω–æ–ø–∫–∞ "–°–æ–∑–¥–∞—Ç—å" —Å–ø—Ä–∞–≤–∞ #}
  <div class="d-flex align-items-center justify-content-between mb-3">
    <div>
      <h1 class="page-title m-0">Mes t√¢ches</h1>
      <div class="page-subtitle">Toutes vos t√¢ches au m√™me endroit</div>
    </div>

    <a class="btn btn-create mb-3" href="{{ path('app_task_new') }}">
      Cr√©er une t√¢che
    </a>
  </div>

  {# ============================
     1) –°–õ–û–í–ê–†–¨ –°–¢–ê–¢–£–°–û–í
     ============================ #}
  {# ‚üµ ADDED: –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ -> –º–µ—Ç–∫–∞ (—á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º) –∏ css-–∫–ª–∞—Å—Å –±–µ–π–¥–∂–∞ (—Ü–≤–µ—Ç) #}
  {% set STATUS = {
    'todo':   {'label': '√Ä faire',  'badge': 'badge-todo'},
    'doing':  {'label': 'En cours', 'badge': 'badge-doing'},
    'done':   {'label': 'Termin√©',  'badge': 'badge-done'},
    'urgent': {'label': 'Urgent',   'badge': 'badge-other'}  # –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–ª–∞—Å—Å
  } %}

  {# –ö–∞—Ä—Ç–æ—á–∫–∞ —Å —Ç–∞–±–ª–∏—Ü–µ–π #}
  <div class="card-glass table-card shadow-sm">
    <div class="table-responsive">
      <table class="table align-middle mb-0">
        <thead>
          <tr>
            <th style="width:72px">#</th>
            <th>Titre</th>
            <th style="width:160px">Statut</th>
            <th class="text-end" style="width:160px">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for task in tasks %}
            <tr>
              <td class="text-muted">{{ task.id }}</td>
              <td>{{ task.title }}</td>

              {# ============================
                 2) –í–´–í–û–î –°–¢–ê–¢–£–°–ê
                 ============================ #}
              {# ‚üµ REPLACED: –∑–∞–º–µ–Ω–∏–ª–∏ —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É –Ω–∞ —Å–ª–æ–≤–∞—Ä—å STATUS #}
              <td>
                {# –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –ë–î: –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä + —É–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã/–ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏—è #}
                {% set code = (task.status ?? '')|lower|replace({' ':'','_':''}) %}
                {% set meta = STATUS[code] ?? null %}

                {% if meta %}
                  <span class="badge status-badge {{ meta.badge }}">{{ meta.label }}</span>
                {% else %}
                  {# –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç, –µ—Å–ª–∏ –≤ –ë–î –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ #}
                  <span class="badge status-badge badge-other">{{ task.status }}</span>
                {% endif %}
              </td>

              {# –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π #}
              <td class="text-end">
                <div class="btn-group btn-group-sm action-group d-flex justify-content-end">
                  <a class="btn btn-action btn-show" title="Voir"
                     href="{{ path('app_task_show', {id: task.id}) }}">üëÅ</a>
                  <a class="btn btn-action btn-edit" title="Modifier"
                     href="{{ path('app_task_edit', {id: task.id}) }}">‚úèÔ∏è</a>
                  {{ include('task/_delete_form.html.twig', { task: task }) }}
                </div>
              </td>
            </tr>
          {% else %}
            <tr>
              <td colspan="4" class="text-center text-muted py-4">
                Aucune t√¢che pour le moment.
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}